<!doctype html>
<head>
  <meta charset="utf-8">
  <title>Canadian Auto Insurance Claims Study</title>
  <meta name="author" content="Jim Vallandingham">
  <meta name="description" content="">

  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/stepper.css">

  <script src="js/d3.v2.min.js"></script>
</head>
<body>
  <div id="container">
    <h1>Canadian Auto Insurance Claims Study</h1>
    <h2 class="subtitle"></h2>
    <div id="vis-nav">
      <a href="#" id="step1" class="step-link active">Step1</a>
      <a href="#" id="step2" class="step-link">Step2</a>
      <a href="#" id="step3" class="step-link">Step3</a>
    </div>
    <div id="vis-container">
      <div id="annotation-steps">
        <div class="annotation-step" id="step1-annotation" style="display:block;">
          <div class="annotation" id="step1-left-annotation" >
            <h4>Comprehensive Claims Data from 2003 to 2015</h4>
            
            
            <head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" href="../base.css">
    <script src="//d3js.org/d3.v4.min.js" charset="utf-8"></script>
    <style>
        .labels {
            fill: white;
        }
    </style>
</head>
<body>
    <input type="button" onclick="update()" value="Update"/>
    <title>Text</title>
    <input type="range" value="50" min="0" max="100" id="maximum">
    <div id="vis">
    </div>
    <script>
    var width = 600;
var height = 350;

var maxValue = d3.select('#maximum')
    .node()
    .value;

var margin = {
    top: 20,
    left: 10,
    right: 30,
    bottom: 10
};

var svg = d3.select("#vis")
    .append("svg")
    .attr('width', width)
    .attr('height', height)
    .append("g")
    .attr("transform", "translate(" + margin.top + "," + margin.left + ")");

width = width - margin.left - margin.right;
height = height - margin.top - margin.bottom;

var yscale = d3.scaleLinear()
    .range([height, 0])
    .domain([0,150]);

var xscale = d3.scaleBand()
    .domain([2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015])
    .range([0, width])
    .padding(0.1);
    

    
var duration = 1000;

var xaxis = d3.axisBottom(xscale);

var yaxis = d3.axisLeft(yscale);

svg.append('g')
    .attr('transform', 'translate(0, ' + (height) + ')')
    .attr('class', 'x axis');

svg.append('g')
    .attr('class', 'y axis');

function update() {

    maxValue = d3.select('#maximum')
        .node()
        .value;
    var exampleData = [64.33,72.24, 76.15,89.32,96.58,104.7,108.1,116.7,
                       123.3,135.1,146.5,154.5,144.4];
    var exampleData_2 = [2003,2004,2005,2006,2007,2008,2009,2010,2011,2012
                         ,2013,2014,2015];
    maxValue = d3.max(exampleData);

    xscale.domain(d3.range(exampleData_2.length));
    //xscale.domain(exampleData_2);
    //xscale.domain(["2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013","2014","2015"]);
    yscale.domain([0, maxValue]);

    var bars = svg.selectAll(".bar")
        .data(exampleData);

    bars
        .enter()
        .append('rect')
        .attr('class', 'bar')
        .attr("fill", "green")
        .attr('width', xscale.bandwidth())
        .attr('height', 0)
        .attr('y', height)
        .merge(bars)
        .transition()
        .duration(duration)
        .attr("height", function(d, i) {
            return height - yscale(d);
        })
        .attr("y", function(d, i) {
            return yscale(d);
        })
        .attr("width", xscale.bandwidth())
        .attr("x", function(d, i) {
            return xscale(i);
        })
        


    bars
        .exit()
        .transition()
        .duration(duration)
        .attr('height', 0)
        .attr('y', height)
        .remove();

    var labels = svg.selectAll('.label')
        .data(exampleData);

    var new_labels = labels
        .enter()
        .append('text')
        .attr('class', 'label')
        .attr('opacity', 0)
        .attr('y', height)
        .attr('fill', 'white')
        .attr('text-anchor', 'middle')

    new_labels.merge(labels)
        .transition()
        .duration(duration)
        .attr('opacity', 1)
        .attr('x', function(d, i) {
            return xscale(i) + xscale.bandwidth() / 2;
        })
        .attr('y', function(d) {
            return yscale(d) + 20;
        })
        .text(function(d) {
            return d ;
        });

    labels
        .exit()
        .transition()
        .duration(duration)
        .attr('y', height)
        .attr('opacity', 0)
        .remove();

    svg.select('.x.axis')
        .transition()
        .duration(duration)
        .call(xaxis);

    svg.select('.y.axis')
        .transition()
        .duration(duration)
        .call(yaxis);

}

update();
    </script>
</body>
            
            
            
            
            
            
            
            
            
            
            <p>Here is the annotation text for the <strong>left</strong> annotation of step 1</p>
         
            
            
        </div>
        <div class="annotation-step" id="step2-annotation">
          <div class="annotation" id="step2-center-annotation" >
            <h4>Center Annotation Title</h4>
            <p>Here is the annotation text for the center annotation of step 2.<br/> 
              We are using absolute positioning of these divs</p>
          </div>
        </div>
        <div class="annotation-step" id="step3-annotation">
          <div class="annotation" id="step3-high-annotation" >
            <h4>High Annotation Title</h4>
            <p>This is text up high.</p>
          </div>
          <div class="annotation" id="step3-low-annotation" >
            <h4>Low Annotation Title</h4>
            <p>This is text down low.</p>
          </div>
        </div>
      </div>
      <div id="vis-canvas"></div>
    </div>
  </div>
  <script src="js/stepper.js"></script>
</body>
